<h2>Agent — Dynamic Form</h2>

<div class="bar">
  <input class="filter" placeholder="Filter grid…" [value]="filterText()" (input)="onFilterInput($any($event.target).value)" aria-label="Filter submitted records"/>
</div>

<form [formGroup]="form" (ngSubmit)="submit()" class="form" novalidate>
  <div class="row"><label for="fullName">Full Name</label><input id="fullName" formControlName="fullName" autocomplete="name"/></div>
  <div class="row"><label for="email">Email</label><input id="email" type="email" formControlName="email" autocomplete="email"/></div>

  <div class="row">
    <label for="region">Region</label>
    <select id="region" formControlName="region">
      <option *ngFor="let r of regions" [value]="r">{{ r }}</option>
    </select>
    <small class="err" *ngIf="form.get('region')?.hasError('notInRegion')">Must be one of {{ regions.join(', ') }}</small>
  </div>

  <div class="row"><label for="shiftTiming">Shift Timing</label><input id="shiftTiming" formControlName="shiftTiming" placeholder="e.g., 09:00-17:00"/></div>

  <div class="row">
    <label for="supervisorId">Supervisor ID</label>
    <input id="supervisorId" placeholder="SUP-1234" formControlName="supervisorId"/>
    <small class="err" *ngIf="form.get('supervisorId')?.pending">Checking supervisor…</small>
    <small class="err" *ngIf="form.get('supervisorId')?.hasError('noSuchSupervisor')">Invalid Supervisor ID</small>
  </div>

  <button type="submit" [disabled]="form.invalid">Submit</button>
</form>

<h3>Submitted Records</h3>
<table class="grid" *ngIf="view().length">
  <thead><tr>
    <th (click)="setSort('fullName')">Full Name</th>
    <th (click)="setSort('email')">Email</th>
    <th (click)="setSort('region')">Region</th>
    <th (click)="setSort('shiftTiming')">Shift</th>
    <th (click)="setSort('supervisorId')">Supervisor</th>
  </tr></thead>
  <tbody><tr *ngFor="let r of view()">
    <td>{{r.fullName}}</td><td>{{r.email}}</td><td>{{r.region}}</td><td>{{r.shiftTiming}}</td><td>{{r.supervisorId}}</td>
  </tr></tbody>
</table>
<p *ngIf="!view().length">No records yet.</p>
