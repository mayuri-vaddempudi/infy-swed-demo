<h2>Customer — Dynamic Form</h2>

<form [formGroup]="form" (ngSubmit)="submit()" class="form" novalidate>
  <!-- Full Name -->
  <div class="row">
    <label for="fullName">Full Name</label>
    <input id="fullName" formControlName="fullName" />
  </div>

  <!-- Email -->
  <div class="row">
    <label for="email">Email</label>
    <input id="email" type="email" formControlName="email" />
    <small
      class="err"
      *ngIf="form.get('email')?.hasError('email') && (form.get('email')?.touched || submitted)"
    >
      Invalid email
    </small>
  </div>

  <!-- Phone -->
  <div class="row">
    <label for="phone">Phone (10 digits)</label>
    <input id="phone" type="tel" inputmode="numeric" maxlength="10" formControlName="phone" />
    <small
      class="err"
      *ngIf="
        form.get('phone')?.hasError('phoneFormat') && (form.get('phone')?.touched || submitted)
      "
    >
      Phone must be exactly 10 digits
    </small>
  </div>

  <!-- Preferred Contact -->
  <div class="row">
    <label for="preferredContact">Preferred Contact</label>
    <select id="preferredContact" formControlName="preferredContact">
      <option value="" disabled>Select…</option>
      <option>Email</option>
      <option>Phone</option>
    </select>
  </div>

  <!-- Address (required if contact = Phone) -->
  <div class="row">
    <label for="address">Address</label>
    <input id="address" formControlName="address" />
    <small
      class="err"
      *ngIf="
        form.get('address')?.hasError('required') && (form.get('address')?.touched || submitted)
      "
    >
      Address is required when Preferred Contact is Phone
    </small>
  </div>

  <button type="submit">Submit</button>
</form>

<h3>Submitted Records</h3>
<table class="grid" *ngIf="rows().length; else emptyState">
  <thead>
    <tr>
      <th>Full Name</th>
      <th>Email</th>
      <th>Phone</th>
      <th>Preferred</th>
      <th>Address</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let r of rows()">
      <td>{{ r.fullName || '—' }}</td>
      <td>{{ r.email || '—' }}</td>
      <td>{{ r.phone || '—' }}</td>
      <td>{{ r.preferredContact || '—' }}</td>
      <td>{{ r.address || '—' }}</td>
    </tr>
  </tbody>
</table>

<ng-template #emptyState>
  <p class="muted">No records yet.</p>
</ng-template>
